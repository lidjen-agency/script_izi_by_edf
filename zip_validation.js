const postalCodesMapping = {
  "renovation bordeaux": [
    '33000',
    '33100',
    '33110',
    '33114',
    '33120',
    '33126',
    '33127',
    '33130',
    '33140',
    '33141',
    '33150',
    '33160',
    '33170',
    '33185',
    '33200',
    '33210',
    '33240',
    '33260',
    '33270',
    '33290',
    '33300',
    '33310',
    '33320',
    '33330',
    '33360',
    '33370',
    '33380',
    '33400',
    '33410',
    '33420',
    '33440',
    '33450',
    '33460',
    '33470',
    '33480',
    '33500',
    '33520',
    '33530',
    '33550',
    '33560',
    '33600',
    '33610',
    '33620',
    '33640',
    '33650',
    '33670',
    '33700',
    '33710',
    '33720',
    '33750',
    '33760',
    '33770',
    '33800',
    '33810',
    '33850',
    '33870',
    '33880'
  ],
  "renovation marseille": [
    "13201",
    "13202",
    "13203",
    "13204",
    "13205",
    "13206",
    "13207",
    "13208",
    "13209",
    "13210",
    "13211",
    "13212",
    "13213",
    "13214",
    "13215",
    "13216",
    "13001",
    "13001",
    "13001",
    "13095",
    "13012",
    "13109",
    "13090",
    "13062",
    "13107",
    "13077",
    "13118",
    "13031",
    "13500",
    "13101",
    "13041",
    "13114",
    "13073",
    "13117",
    "13014",
    "13071",
    "13043",
    "13002",
    "13026",
    "13106",
    "13022",
    "13039",
    "13001",
    "13103",
    "13015",
    "13081",
    "13086",
    "13075",
    "13007",
    "13005",
    "13042",
    "13119",
    "13019",
    "13056",
    "13032",
    "13001",
    "13037",
    "13060",
    "13023",
    "13028",
    "13021",
    "13051",
    "13054",
    "13040",
    "13016",
    "13013",
    "13102",
    "13088",
    "13113",
    "13030",
    "83105",
    "13072",
    "13025",
    "13087",
    "13033",
    "13070",
    "13085",
    "13046",
    "13112",
    "13098",
    "13020",
    "13104",
    "83112",
    "83093",
    "83120",
    "83027",
    "84089",
    "84024"
  ],
  "renovation nice": [
    '06000',
    '06100',
    '06110',
    '06140',
    '06150',
    '06160',
    '06190',
    '06200',
    '06210',
    '06220',
    '06230',
    '06240',
    '06250',
    '06270',
    '06300',
    '06310',
    '06320',
    '06330',
    '06340',
    '06360',
    '06370',
    '06380',
    '06390',
    '06400',
    '06410',
    '06440',
    '06480',
    '06500',
    '06510',
    '06550',
    '06560',
    '06570',
    '06580',
    '06590',
    '06600',
    '06610',
    '06640',
    '06650',
    '06670',
    '06690',
    '06700',
    '06730',
    '06740',
    '06790',
    '06800',
    '06830',
    '06950',
  ],
  "renovation toulouse": [
    '11410',
    '11410',
    '31000',
    '31100',
    '31120',
    '31130',
    '31140',
    '31150',
    '31170',
    '31180',
    '31190',
    '31200',
    '31220',
    '31240',
    '31270',
    '31280',
    '31290',
    '31300',
    '31320',
    '31330',
    '31340',
    '31370',
    '31380',
    '31390',
    '31400',
    '31410',
    '31430',
    '31450',
    '31460',
    '31470',
    '31490',
    '31500',
    '31520',
    '31530',
    '31560',
    '31570',
    '31590',
    '31600',
    '31620',
    '31650',
    '31660',
    '31670',
    '31700',
    '31750',
    '31770',
    '31780',
    '31790',
    '31810',
    '31820',
    '31830',
    '31840',
    '31850',
    '31860',
    '31870',
    '31880',
    '32490',
    '32600',
    '81370',
    '81500',
    '81800',
    '82170',
    '82370',
    '82600'
  ],
  "renovation IDF": [
    '75000',
    '75001',
    '75002',
    '75003',
    '75004',
    '75005',
    '75006',
    '75007',
    '75008',
    '75009',
    '75010',
    '75011',
    '75012',
    '75013',
    '75014',
    '75015',
    '75016',
    '75017',
    '75018',
    '75019',
    '75020',
    '75116',
    '77000',
    '77090',
    '77100',
    '77111',
    '77114',
    '77115',
    '77118',
    '77120',
    '77122',
    '77123',
    '77124',
    '77126',
    '77127',
    '77130',
    '77131',
    '77133',
    '77134',
    '77135',
    '77138',
    '77139',
    '77140',
    '77141',
    '77144',
    '77145',
    '77148',
    '77150',
    '77151',
    '77154',
    '77156',
    '77157',
    '77160',
    '77163',
    '77164',
    '77165',
    '77166',
    '77167',
    '77169',
    '77170',
    '77171',
    '77173',
    '77174',
    '77176',
    '77177',
    '77178',
    '77181',
    '77183',
    '77184',
    '77185',
    '77186',
    '77190',
    '77200',
    '77210',
    '77220',
    '77230',
    '77240',
    '77250',
    '77260',
    '77270',
    '77280',
    '77290',
    '77300',
    '77310',
    '77320',
    '77330',
    '77340',
    '77350',
    '77360',
    '77370',
    '77380',
    '77390',
    '77400',
    '77410',
    '77420',
    '77430',
    '77440',
    '77450',
    '77460',
    '77470',
    '77480',
    '77500',
    '77510',
    '77515',
    '77520',
    '77540',
    '77550',
    '77560',
    '77570',
    '77580',
    '77590',
    '77600',
    '77610',
    '77620',
    '77630',
    '77640',
    '77650',
    '77660',
    '77670',
    '77680',
    '77690',
    '77700',
    '77710',
    '77720',
    '77730',
    '77750',
    '77760',
    '77780',
    '77810',
    '77820',
    '77830',
    '77840',
    '77850',
    '77860',
    '77870',
    '77880',
    '77890',
    '77910',
    '77920',
    '77930',
    '77940',
    '77950',
    '77970',
    '77990',
    '78000',
    '78100',
    '78110',
    '78111',
    '78112',
    '78113',
    '78114',
    '78117',
    '78120',
    '78121',
    '78124',
    '78125',
    '78126',
    '78130',
    '78140',
    '78150',
    '78160',
    '78170',
    '78180',
    '78190',
    '78200',
    '78210',
    '78220',
    '78230',
    '78240',
    '78250',
    '78260',
    '78270',
    '78280',
    '78290',
    '78300',
    '78310',
    '78320',
    '78330',
    '78340',
    '78350',
    '78360',
    '78370',
    '78380',
    '78390',
    '78400',
    '78410',
    '78420',
    '78430',
    '78440',
    '78450',
    '78460',
    '78470',
    '78480',
    '78490',
    '78500',
    '78510',
    '78520',
    '78530',
    '78540',
    '78550',
    '78560',
    '78570',
    '78580',
    '78590',
    '78600',
    '78610',
    '78620',
    '78630',
    '78640',
    '78650',
    '78660',
    '78670',
    '78680',
    '78690',
    '78700',
    '78710',
    '78711',
    '78720',
    '78730',
    '78740',
    '78750',
    '78760',
    '78770',
    '78780',
    '78790',
    '78800',
    '78810',
    '78820',
    '78830',
    '78840',
    '78850',
    '78860',
    '78870',
    '78890',
    '78910',
    '78920',
    '78930',
    '78940',
    '78950',
    '78955',
    '78960',
    '78970',
    '78980',
    '78990',
    '91000',
    '91070',
    '91080',
    '91090',
    '91100',
    '91120',
    '91130',
    '91140',
    '91150',
    '91160',
    '91170',
    '91180',
    '91190',
    '91200',
    '91210',
    '91220',
    '91230',
    '91240',
    '91250',
    '91260',
    '91270',
    '91280',
    '91290',
    '91300',
    '91310',
    '91320',
    '91330',
    '91340',
    '91350',
    '91360',
    '91370',
    '91380',
    '91390',
    '91400',
    '91410',
    '91420',
    '91430',
    '91440',
    '91450',
    '91460',
    '91470',
    '91480',
    '91490',
    '91510',
    '91520',
    '91530',
    '91540',
    '91550',
    '91560',
    '91570',
    '91580',
    '91590',
    '91600',
    '91610',
    '91620',
    '91630',
    '91640',
    '91650',
    '91660',
    '91670',
    '91680',
    '91690',
    '91700',
    '91710',
    '91720',
    '91730',
    '91740',
    '91750',
    '91760',
    '91770',
    '91780',
    '91790',
    '91800',
    '91810',
    '91820',
    '91830',
    '91840',
    '91850',
    '91860',
    '91870',
    '91880',
    '91890',
    '91910',
    '91930',
    '91940',
    '92000',
    '92100',
    '92110',
    '92120',
    '92130',
    '92140',
    '92150',
    '92160',
    '92170',
    '92190',
    '92200',
    '92210',
    '92220',
    '92230',
    '92240',
    '92250',
    '92260',
    '92270',
    '92290',
    '92300',
    '92310',
    '92320',
    '92330',
    '92340',
    '92350',
    '92360',
    '92370',
    '92380',
    '92390',
    '92400',
    '92410',
    '92420',
    '92430',
    '92500',
    '92600',
    '92700',
    '92800',
    '93000',
    '93100',
    '93110',
    '93120',
    '93130',
    '93140',
    '93150',
    '93160',
    '93170',
    '93172',
    '93190',
    '93200',
    '93210',
    '93220',
    '93230',
    '93240',
    '93250',
    '93260',
    '93270',
    '93290',
    '93300',
    '93310',
    '93320',
    '93330',
    '93340',
    '93350',
    '93360',
    '93370',
    '93380',
    '93390',
    '93400',
    '93410',
    '93420',
    '93430',
    '93440',
    '93450',
    '93460',
    '93470',
    '93500',
    '93600',
    '93700',
    '93800',
    '94000',
    '94100',
    '94110',
    '94120',
    '94130',
    '94140',
    '94150',
    '94160',
    '94170',
    '94190',
    '94200',
    '94210',
    '94220',
    '94230',
    '94240',
    '94250',
    '94260',
    '94270',
    '94290',
    '94300',
    '94310',
    '94320',
    '94340',
    '94350',
    '94360',
    '94370',
    '94380',
    '94390',
    '94400',
    '94410',
    '94420',
    '94430',
    '94440',
    '94450',
    '94460',
    '94470',
    '94480',
    '94490',
    '94500',
    '94510',
    '94520',
    '94550',
    '94600',
    '94700',
    '94800',
    '94880',
    '95000',
    '95100',
    '95110',
    '95120',
    '95130',
    '95140',
    '95150',
    '95160',
    '95170',
    '95180',
    '95190',
    '95200',
    '95210',
    '95220',
    '95230',
    '95240',
    '95250',
    '95260',
    '95270',
    '95280',
    '95290',
    '95300',
    '95310',
    '95320',
    '95330',
    '95340',
    '95350',
    '95360',
    '95370',
    '95380',
    '95390',
    '95400',
    '95410',
    '95420',
    '95430',
    '95440',
    '95450',
    '95460',
    '95470',
    '95480',
    '95490',
    '95500',
    '95510',
    '95520',
    '95530',
    '95540',
    '95550',
    '95560',
    '95570',
    '95580',
    '95590',
    '95600',
    '95610',
    '95620',
    '95630',
    '95640',
    '95650',
    '95660',
    '95670',
    '95680',
    '95690',
    '95700',
    '95710',
    '95720',
    '95740',
    '95750',
    '95760',
    '95770',
    '95780',
    '95800',
    '95810',
    '95820',
    '95830',
    '95840',
    '95850',
    '95870',
    '95880'
  ],
  "renovation lille": [
    '59000',
    '59100',
    '59110',
    '59111',
    '59112',
    '59113',
    '59114',
    '59115',
    '59116',
    '59117',
    '59118',
    '59119',
    '59120',
    '59121',
    '59122',
    '59123',
    '59124',
    '59125',
    '59126',
    '59127',
    '59128',
    '59129',
    '59130',
    '59131',
    '59132',
    '59133',
    '59134',
    '59135',
    '59136',
    '59137',
    '59138',
    '59139',
    '59140',
    '59141',
    '59142',
    '59143',
    '59144',
    '59145',
    '59146',
    '59147',
    '59148',
    '59149',
    '59150',
    '59151',
    '59152',
    '59153',
    '59154',
    '59155',
    '59156',
    '59157',
    '59158',
    '59159',
    '59160',
    '59161',
    '59162',
    '59163',
    '59164',
    '59165',
    '59166',
    '59167',
    '59168',
    '59169',
    '59170',
    '59171',
    '59172',
    '59173',
    '59174',
    '59175',
    '59176',
    '59177',
    '59178',
    '59179',
    '59180',
    '59181',
    '59182',
    '59184',
    '59185',
    '59186',
    '59187',
    '59188',
    '59189',
    '59190',
    '59191',
    '59192',
    '59193',
    '59194',
    '59195',
    '59198',
    '59199',
    '59200',
    '59210',
    '59211',
    '59212',
    '59213',
    '59214',
    '59215',
    '59216',
    '59217',
    '59218',
    '59219',
    '59220',
    '59221',
    '59222',
    '59223',
    '59224',
    '59225',
    '59226',
    '59227',
    '59229',
    '59230',
    '59231',
    '59232',
    '59233',
    '59234',
    '59235',
    '59236',
    '59237',
    '59238',
    '59239',
    '59240',
    '59241',
    '59242',
    '59243',
    '59244',
    '59245',
    '59246',
    '59247',
    '59249',
    '59250',
    '59251',
    '59252',
    '59253',
    '59254',
    '59255',
    '59258',
    '59259',
    '59260',
    '59261',
    '59262',
    '59263',
    '59264',
    '59265',
    '59266',
    '59267',
    '59268',
    '59269',
    '59270',
    '59271',
    '59272',
    '59273',
    '59274',
    '59277',
    '59278',
    '59279',
    '59280',
    '59281',
    '59282',
    '59283',
    '59284',
    '59285',
    '59286',
    '59287',
    '59288',
    '59290',
    '59292',
    '59293',
    '59294',
    '59295',
    '59296',
    '59297',
    '59299',
    '59300',
    '59310',
    '59320',
    '59330',
    '59350',
    '59360',
    '59370',
    '59380',
    '59390',
    '59400',
    '59410',
    '59420',
    '59430',
    '59440',
    '59450',
    '59460',
    '59470',
    '59480',
    '59490',
    '59491',
    '59492',
    '59493',
    '59494',
    '59495',
    '59496',
    '59500',
    '59510',
    '59520',
    '59530',
    '59540',
    '59550',
    '59551',
    '59552',
    '59553',
    '59554',
    '59560',
    '59570',
    '59580',
    '59590',
    '59600',
    '59610',
    '59620',
    '59630',
    '59640',
    '59650',
    '59660',
    '59670',
    '59680',
    '59690',
    '59700',
    '59710',
    '59720',
    '59730',
    '59740',
    '59750',
    '59760',
    '59770',
    '59777',
    '59780',
    '59790',
    '59800',
    '59804',
    '59810',
    '59820',
    '59830',
    '59840',
    '59850',
    '59860',
    '59870',
    '59880',
    '59890',
    '59910',
    '59920',
    '59930',
    '59940',
    '59950',
    '59960',
    '59970',
    '59980',
    '59990'
  ]
}

function getPostalCodeZone(postalCode) {
  const entry = Object.entries(postalCodesMapping).find(([_, postalCodes]) => postalCodes.includes(postalCode));
  if (!entry) {
    return null;
  }
  const [zone, _] = entry;
  return zone;
}

document.querySelector('form').addEventListener('submit', (e) => {
  const zone = getPostalCodeZone(document.querySelector('input#zip').value);
  document.querySelector('input#categorie_lead').value = zone || "Hors Zone";
})

document.querySelector('input#zip').addEventListener('blur', (e) => {
  const value = e.target.value;
  const zipIsNotFound = value.length > 0 && !getPostalCodeZone(value);
  if (zipIsNotFound) {
    document.getElementById("btnBlock").style.display = "none";
    document.getElementById("errorZip").style.display = "block";
  } else {
    document.getElementById("btnBlock").style.display = "inline-block";
    document.getElementById("errorZip").style.display = "none";
  }
});

document.querySelector('select#situationpropriete__c').addEventListener('blur', (e) => {
  const value = e.target.value;
  if (value == "Locataire") {
    document.getElementById("errorSituation").style.display = "block";
  } else {
    document.getElementById("errorSituation").style.display = "none";
  }
});

document.querySelector('select#delai_projet').addEventListener('blur', (e) => {
  const value = e.target.value;
  if (value == "Dans plus de 6 mois") {
    document.getElementById("errorTravaux").style.display = "block";
  } else {
    document.getElementById("errorTravaux").style.display = "none";
  }
});

document.querySelector('select#financement_affil').addEventListener('blur', (e) => {
  const value = e.target.value;
  if (value == "non") {
    document.getElementById("errorFinancement").style.display = "block";
  } else {
    document.getElementById("errorFinancement").style.display = "none";
  }
});

document.querySelector('select#budget_global').addEventListener('blur', (e) => {
  const value = e.target.value;
  if (value == "Entre 5 000€ et 10 000€") {
    document.getElementById("errorBudget").style.display = "block";
  } else {
    document.getElementById("errorBudget").style.display = "none";
  }
});


const submitButtons = document.querySelector("#btnBlock");
const hideSubmit = () => {
  submitButtons.style.display = "none";
}
const showSubmit = () => {
  submitButtons.style.display = "inline-block";
}
const visibilityRules = [
  {
    selector: "select#situationpropriete__c",
    isVisible: (value) => {
      if (value === "Locataire") {
        return false;
      }
      return true;
    }
  },
  {
    selector: "select#budget_global",
    isVisible: (value) => {
      if (value === "Entre 5 000€ et 10 000€") {
        return false;
      }
      return true;
    }
  },
  {
    selector: "select#delai_projet",
    isVisible: (value) => {
      if (value === "Dans plus de 6 mois") {
        return false;
      }
      return true;
    }
  },
  {
    selector: "select#financement_affil",
    isVisible: (value) => {
      if (value === "non") {
        return false;
      }
      return true;
    }
  },
]
const handleSubmitVisibility = () => {
  const isVisible = visibilityRules.every(rule => {
    const value = document.querySelector(rule.selector)?.value;
    return rule.isVisible(value);
  });
  if (isVisible) {
    showSubmit();
  } else {
    hideSubmit();
  }
}
visibilityRules.forEach(({ selector }) => document.querySelector(selector).addEventListener("blur", handleSubmitVisibility))


